<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0070)http://www.17sucai.com/preview/586510/2016-07-24/jQuery-tcc/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><script type="text/javascript" src="chrome-extension://kajfghlhfkcocafkcjlajldicbikpgnp/catcher.js"><!-- script injected by Request Maker --></script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="stylesheet" href="./lib/main.css">
<script type="text/javascript" src="http://lib.sinaapp.com/js/jquery/1.10.2/jquery-1.10.2.min.js"></script>

<title>遮罩弹窗居中demo</title>

</head>

<body>

<div>
	<button type="button" id="ClickMe">点击显示弹窗遮罩</button>
</div>

<div id="goodcover" style="display: none;"></div>
	
<div id="code" style="position: absolute; top: 71.5px; left: 533px; display: none;">
  <div class="close1"><a href="javascript:void(0)" id="closebt"><img src="./lib/close.gif" id="aeaoofnhgocdbnbeljkmbjdmhbcokfdb-mousedown"></a></div>
  <div class="goodtxt">
    <p>微信扫一扫</p>
    <p>将您的团购分享到朋友圈</p>
    <p>让更多朋友知道哦~</p>
  </div>
  <div class="code-img"> <img id="ewmsrc" src="./lib/code.jpg"></div>
</div>

<script>
$(function() {
    //alert($(window).height());
    $('#ClickMe').click(function() {
        $('#code').center();
        $('#goodcover').show();
        $('#code').fadeIn();
    });
    $('#closebt').click(function() {
        $('#code').hide();
        $('#goodcover').hide();
    });
	$('#goodcover').click(function() {
        $('#code').hide();
        $('#goodcover').hide();
    });
    /*var val=$(window).height();
	var codeheight=$("#code").height();
    var topheight=(val-codeheight)/2;
	$('#code').css('top',topheight);*/
    jQuery.fn.center = function(loaded) {
        var obj = this;
        body_width = parseInt($(window).width());
        body_height = parseInt($(window).height());
        block_width = parseInt(obj.width());
        block_height = parseInt(obj.height());

        left_position = parseInt((body_width / 2) - (block_width / 2) + $(window).scrollLeft());
        if (body_width < block_width) {
            left_position = 0 + $(window).scrollLeft();
        };

        top_position = parseInt((body_height / 2) - (block_height / 2) + $(window).scrollTop());
        if (body_height < block_height) {
            top_position = 0 + $(window).scrollTop();
        };

        if (!loaded) {

            obj.css({
                'position': 'absolute'
            });
            obj.css({
                'top': ($(window).height() - $('#code').height()) * 0.5,
                'left': left_position
            });
            $(window).bind('resize', function() {
                obj.center(!loaded);
            });
            $(window).bind('scroll', function() {
                obj.center(!loaded);
            });

        } else {
            obj.stop();
            obj.css({
                'position': 'absolute'
            });
            obj.animate({
                'top': top_position
            }, 200, 'linear');
        }
    }

})
</script>


</body></html>